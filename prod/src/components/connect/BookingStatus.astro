---
interface Props {
  status?: 'available' | 'limited' | 'unavailable';
  statusText?: string;
}

const { status = 'available', statusText } = Astro.props;

const statusConfig = {
  available: {
    text: statusText || 'NOW BOOKING',
    color: '#22c55e',
    bgColor: 'rgba(34, 197, 94, 0.1)',
    borderColor: 'rgba(34, 197, 94, 0.3)',
  },
  limited: {
    text: statusText || 'LIMITED AVAILABILITY',
    color: '#f59e0b',
    bgColor: 'rgba(245, 158, 11, 0.1)',
    borderColor: 'rgba(245, 158, 11, 0.3)',
  },
  unavailable: {
    text: statusText || 'CURRENTLY BOOKED',
    color: '#ef4444',
    bgColor: 'rgba(239, 68, 68, 0.1)',
    borderColor: 'rgba(239, 68, 68, 0.3)',
  },
};

const config = statusConfig[status];
---

<div class="booking-status" style={`--status-color: ${config.color}; --status-bg: ${config.bgColor}; --status-border: ${config.borderColor};`}>
  <div class="status-indicator">
    <span class="status-dot"></span>
    <span class="status-text">{config.text}</span>
  </div>
  <div class="broadcast-frame" aria-hidden="true">
    <span class="frame-corner tl"></span>
    <span class="frame-corner tr"></span>
    <span class="frame-corner bl"></span>
    <span class="frame-corner br"></span>
  </div>
</div>

<style>
  .booking-status {
    position: relative;
    display: inline-flex;
    align-items: center;
    padding: 0.5rem 1rem;
    background: var(--status-bg);
    border: 1px solid var(--status-border);
    font-family: var(--font-mono);
  }

  .status-indicator {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .status-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--status-color);
    box-shadow: 0 0 8px var(--status-color);
    animation: pulse-glow 2s ease-in-out infinite;
  }

  .status-text {
    font-size: 0.7rem;
    font-weight: 700;
    letter-spacing: 0.15em;
    color: var(--status-color);
  }

  .broadcast-frame {
    position: absolute;
    inset: -2px;
    pointer-events: none;
  }

  .frame-corner {
    position: absolute;
    width: 8px;
    height: 8px;
    border: 2px solid var(--status-color);
    opacity: 0.6;
  }

  .frame-corner.tl {
    top: 0;
    left: 0;
    border-right: none;
    border-bottom: none;
  }

  .frame-corner.tr {
    top: 0;
    right: 0;
    border-left: none;
    border-bottom: none;
  }

  .frame-corner.bl {
    bottom: 0;
    left: 0;
    border-right: none;
    border-top: none;
  }

  .frame-corner.br {
    bottom: 0;
    right: 0;
    border-left: none;
    border-top: none;
  }

  @keyframes pulse-glow {
    0%, 100% {
      opacity: 1;
      box-shadow: 0 0 8px var(--status-color);
    }
    50% {
      opacity: 0.6;
      box-shadow: 0 0 16px var(--status-color);
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .status-dot {
      animation: none;
    }
  }
</style>
